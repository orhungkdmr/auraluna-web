{% load static %}
<div class="d-flex align-items-center header-icons-right"> 

    {% if user.is_authenticated %}
        {# --- Giriş Yapmış Kullanıcı --- #}
        <ul class="navbar-nav flex-row align-items-center">
            
            {# Hesabım Dropdown #}
            <li class="nav-item dropdown icon-text-link">
                <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="navbarAccountDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" title="Hesabım">
                    <i class="bi bi-person me-1 fs-5"></i> 
                    <span class="d-none d-lg-inline">Hesabım</span> {# Sadece masaüstünde metni göster #}
                </a>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarAccountDropdown">
                    <li class="dropdown-header">Merhaba, {{ user.username }}</li>
                    <li><a class="dropdown-item" href="{% url 'accounts:account_profile' %}" title="Hesap Bilgileri"><i class="bi bi-person-badge me-2"></i>Hesap Bilgileri</a></li>
                    <li><a class="dropdown-item" href="{% url 'orders:order_history' %}" title="Siparişlerim"><i class="bi bi-box-seam me-2"></i>Siparişlerim</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li>
                        <form class="d-inline" action="{% url 'logout' %}" method="post">
                            {% csrf_token %}
                            <button type="submit" class="dropdown-item"><i class="bi bi-box-arrow-right me-2"></i>Çıkış Yap</button>
                        </form>
                    </li>
                </ul>
            </li>

            {# Favorilerim #}
            <li class="nav-item ms-3 icon-text-link d-none d-lg-block"> {# Mobildeki menüye taşıdık #}
                <a class="nav-link d-flex align-items-center" href="{% url 'products:favourite_list' %}" title="Favorilerim">
                    <i class="bi bi-heart me-1 fs-5"></i> 
                    <span class="d-none d-lg-inline">Favorilerim</span>
                </a>
            </li>
            <li class="nav-item icon-text-link d-none d-lg-block"> {# Mobildeki menüye taşıdık #}
             <a class="nav-link d-flex align-items-center" href="{% url 'orders:order_tracking' %}" title="Sipariş Takibi">
                <i class="bi bi-truck me-1 fs-5"></i> 
                <span class="d-none d-lg-inline">Sipariş Takibi</span>
             </a>
             </li>

            {# Sepetim #}
            <li class="nav-item ms-3 icon-text-link">
                <a class="nav-link position-relative d-flex align-items-center" href="#" role="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasCart" aria-controls="offcanvasCart" title="Sepetim">
                    <i class="bi bi-cart me-1 fs-5"></i> 
                    <span class="d-none d-lg-inline">Sepetim</span> 
                    <span id="cart-counter"
                          class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                          style="display: {% if cart|length > 0 %}inline-block{% else %}none{% endif %}; font-size: 0.6em; padding: .3em .5em;">
                          {{ cart|length }}
                    </span>
                </a>
            </li>

        </ul>

    {% else %}
        {# --- Giriş Yapmamış Kullanıcı --- #}
        <ul class="navbar-nav flex-row align-items-center">

            {# Giriş Yap Dropdown (sadece ikon görünüyor, metin gizlendi) #}
            <li class="nav-item dropdown icon-text-link">
                 <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="navbarAccountDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" title="Giriş Yap">
                    <i class="bi bi-person me-1 fs-5"></i> 
                    <span class="d-none d-lg-inline">Giriş Yap</span>
                </a>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarAccountDropdown">
                    <li><a class="dropdown-item" href="{% url 'login' %}">Giriş Yap</a></li>
                    <li><a class="dropdown-item" href="{% url 'accounts:signup' %}">Kayıt Ol</a></li>
                    <li><a class="dropdown-item" href="{% url 'orders:order_tracking' %}">Sipariş Takibi</a></li>
                </ul>
            </li>

             {# Favorilerim #}
            <li class="nav-item ms-3 icon-text-link d-none d-lg-block">
                <a class="nav-link d-flex align-items-center" href="{% url 'login' %}?next={% url 'products:favourite_list' %}" title="Favorilerim"> 
                    <i class="bi bi-heart me-1 fs-5"></i> 
                    <span class="d-none d-lg-inline">Favorilerim</span>
                </a>
            </li>
            
            {# Sepetim #}
            <li class="nav-item ms-3 icon-text-link">
                <a class="nav-link position-relative d-flex align-items-center" href="#" role="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasCart" aria-controls="offcanvasCart" title="Sepetim">
                    <i class="bi bi-cart me-1 fs-5"></i> 
                    <span class="d-none d-lg-inline">Sepetim</span> 
                     <span id="cart-counter"
                          class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                          style="display: {% if cart|length > 0 %}inline-block{% else %}none{% endif %}; font-size: 0.6em; padding: .3em .5em;">
                          {{ cart|length }}
                    </span>
                </a>
            </li>
            
        </ul>
    {% endif %}

</div>